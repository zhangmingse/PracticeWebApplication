<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>

	<div>
		<input type="submit" value="GetBase64" onclick="getbase64()" />
		<input type="submit" value="GetBinary" onclick="getbinary()" />
	</div>
	<div id="messages"></div>
	<img id="imagebase64"></img>
	<canvas id="imagecanvas" width="500" height="500">Your browser does not support the HTML5 canvas tag </canvas>
	<script type="text/javascript">
		var imagecanvas = document.getElementById("imagecanvas");
		var ctx = imagecanvas.getContext("2d");

		var image = new Image();
		image.onload = function() {
			mydate = new Date();
			t2 = mydate.getTime();
			ctx.drawImage(image, 0, 0);
			mydate = new Date();
			t3 = mydate.getTime();
			console.log(t1 +"  "+t2+"  "+t3);
			console.log((t2-t1) + " " + (t3-t2));
			console.log("=======================");
		}

		var webSocket = new WebSocket(
				'ws://localhost:8080/PraticeWebApplication/websocket');

		webSocket.onerror = function(event) {
			onError(event)
		};

		webSocket.onopen = function(event) {
			onOpen(event)
		};

		webSocket.onmessage = function(event) {
			onMessage(event)
		};

		
		var t1 = 0;
		var t2 = 0;
		var t3 = 0;
		var mydate = new Date();
		function onMessage(event) {

			
			// 	     document.getElementById('messages').innerHTML 
			//    	    += '<br />' + event.data;
			//document.getElementById('imagebase64').src = 'data:image/png;base64,'+event.data;
			if(typeof(event.data) == "string"){
				
				image.src = 'data:image/png;base64,' + event.data;	
			}else{
				var reader = new FileReader();
				reader.onload = function(event){
					if(event.target.readyState == FileReader.DONE){
						var url = event.target.result;
						image.src = url;
					}
				}
				
				reader.readAsDataURL(event.data);
			}
			

		}

		function onOpen(event) {
			document.getElementById('messages').innerHTML = 'Connection established';
		}

		function onError(event) {
			alert(event.data);
		}

		function getbase64() {
			mydate = new Date();
			t1 = mydate.getTime();
			webSocket.send('base64');
			return false;
		}
		function getbinary() {
			mydate = new Date();
			t1 = mydate.getTime();
			webSocket.send('binary');
			return false;
		}
	</script>
</body>
</html>